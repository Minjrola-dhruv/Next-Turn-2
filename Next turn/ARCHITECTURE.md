# ğŸ“Š Next Turn System Architecture

## ğŸ—ï¸ High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    VERCEL DEPLOYMENT                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   Static Files   â”‚         â”‚  API Functions   â”‚          â”‚
â”‚  â”‚   (CDN Cached)   â”‚         â”‚  (Serverless)    â”‚          â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
â”‚  â”‚ â€¢ index.html     â”‚         â”‚ â€¢ queue-join.js  â”‚          â”‚
â”‚  â”‚ â€¢ admin.html     â”‚         â”‚ â€¢ check-notif.js â”‚          â”‚
â”‚  â”‚ â€¢ join.html      â”‚         â”‚ â€¢ calc-time.js   â”‚          â”‚
â”‚  â”‚ â€¢ *.css          â”‚         â”‚ â€¢ test-email.js  â”‚          â”‚
â”‚  â”‚ â€¢ *.js           â”‚         â”‚ â€¢ health.js      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Firebase   â”‚   â”‚    Gmail     â”‚   â”‚ Google AI    â”‚
â”‚   Database   â”‚   â”‚    SMTP      â”‚   â”‚   Gemini     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Realtime   â”‚   â”‚ â€¢ Nodemailer â”‚   â”‚ â€¢ Wait time  â”‚
â”‚   updates    â”‚   â”‚ â€¢ Beautiful  â”‚   â”‚   AI calc    â”‚
â”‚ â€¢ Auth       â”‚   â”‚   templates  â”‚   â”‚ â€¢ Analytics  â”‚
â”‚ â€¢ Security   â”‚   â”‚ â€¢ Delivery   â”‚   â”‚ â€¢ Patterns   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ User Flow Diagram

### 1. Queue Joining Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USER   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚ 1. Scans QR Code
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   join.html?placeId=X   â”‚
â”‚   (Queue Join Page)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ 2. Fills form
             â”‚    â€¢ Name
             â”‚    â€¢ Email
             â”‚    â€¢ Priority
             â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   Submit Form â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ 3. POST /api/queue-join
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API: queue-join.js        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Validate input          â”‚
â”‚ 2. Get place info          â”‚
â”‚ 3. Calculate position      â”‚
â”‚ 4. Call Gemini AI          â”‚
â”‚ 5. Save to Firebase        â”‚
â”‚ 6. Send email              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
     â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Firebase â”‚    â”‚     Gmail     â”‚
â”‚  Save   â”‚    â”‚  Send Email   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                â”‚
     â”‚                â–¼
     â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚         â”‚   USER'S    â”‚
     â”‚         â”‚   INBOX     â”‚
     â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Return Token   â”‚
â”‚  Show Position  â”‚
â”‚  Display Wait   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2. Notification Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ADMIN    â”‚
â”‚   Panel     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 1. Clicks "Call Next" or "Complete"
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Update Status  â”‚
â”‚   in Firebase   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 2. Trigger notification check
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/check-notifications â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API: check-notifications.js â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Get all waiting users     â”‚
â”‚ 2. Calculate positions       â”‚
â”‚ 3. Check if notification due â”‚
â”‚ 4. Send emails               â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”
       â–¼      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚2 Ahead?  â”‚ â”‚Your Turn?â”‚
â”‚Send Soon â”‚ â”‚Send Now  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚            â”‚
     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    Gmail    â”‚
    â”‚   Sends     â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   USERS     â”‚
    â”‚  Notified   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“§ Email Notification Timeline

```
User Position Timeline:

Position 10 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
               â”‚
               â”‚ No email yet
               â–¼
Position 5 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
               â”‚
               â”‚ Still waiting...
               â–¼
Position 3 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
               â”‚
               â”‚ Still no email
               â–¼
Position 2 â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
               â”‚
               â”‚ âš ï¸ EMAIL: "Your Turn Soon"
               â”‚    "2 people ahead"
               â–¼
Position 1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
               â”‚
               â”‚ Getting close...
               â–¼
Position 0 â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
               â”‚
               â”‚ âœ… EMAIL: "Your Turn Now"
               â”‚    "Proceed to counter"
               â–¼
    Called â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
               â”‚
               â”‚ User goes to counter
               â–¼
   Completed â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

---

## ğŸ”§ API Function Details

### queue-join.js
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      queue-join.js          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ INPUT:                      â”‚
â”‚ â€¢ placeId                   â”‚
â”‚ â€¢ name, email               â”‚
â”‚ â€¢ priorityType              â”‚
â”‚                             â”‚
â”‚ PROCESS:                    â”‚
â”‚ 1. Validate inputs          â”‚
â”‚ 2. Get place from Firebase  â”‚
â”‚ 3. Count waiting queue      â”‚
â”‚ 4. Calculate position       â”‚
â”‚    (priority users first)   â”‚
â”‚ 5. Generate token           â”‚
â”‚ 6. Call AI for wait time    â”‚
â”‚ 7. Save to Firebase         â”‚
â”‚ 8. Send confirmation email  â”‚
â”‚                             â”‚
â”‚ OUTPUT:                     â”‚
â”‚ â€¢ queueId                   â”‚
â”‚ â€¢ token (T-ABC123)          â”‚
â”‚ â€¢ position (#3)             â”‚
â”‚ â€¢ estimatedTime (15 min)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### check-notifications.js
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   check-notifications.js    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ INPUT:                      â”‚
â”‚ â€¢ placeId                   â”‚
â”‚                             â”‚
â”‚ PROCESS:                    â”‚
â”‚ 1. Get all queue entries    â”‚
â”‚ 2. Filter waiting status    â”‚
â”‚ 3. For each person:         â”‚
â”‚    a. Count people ahead    â”‚
â”‚    b. If 2 ahead & not sent:â”‚
â”‚       - Send "soon" email   â”‚
â”‚       - Mark notification   â”‚
â”‚    c. If 0 ahead:           â”‚
â”‚       - Send "now" email    â”‚
â”‚       - Update to "called"  â”‚
â”‚                             â”‚
â”‚ OUTPUT:                     â”‚
â”‚ â€¢ notifications sent count  â”‚
â”‚ â€¢ notification details      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### calculate-wait-time.js
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   calculate-wait-time.js    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ INPUT:                      â”‚
â”‚ â€¢ placeId                   â”‚
â”‚ â€¢ position                  â”‚
â”‚ â€¢ priorityType              â”‚
â”‚                             â”‚
â”‚ PROCESS:                    â”‚
â”‚ 1. Get analytics data       â”‚
â”‚ 2. Call Gemini AI:          â”‚
â”‚    - Position in queue      â”‚
â”‚    - Priority type          â”‚
â”‚    - Historical avg         â”‚
â”‚    - Peak hours             â”‚
â”‚ 3. Parse AI response        â”‚
â”‚ 4. Fallback if AI fails     â”‚
â”‚                             â”‚
â”‚ OUTPUT:                     â”‚
â”‚ â€¢ estimatedMinutes (18)     â”‚
â”‚ â€¢ confidence (85%)          â”‚
â”‚ â€¢ factors (explanation)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ Firebase Database Structure

```
nextturn-8217f/
â”‚
â”œâ”€â”€ places/
â”‚   â””â”€â”€ {placeId}/
â”‚       â”œâ”€â”€ name: "Hospital XYZ"
â”‚       â”œâ”€â”€ category: "healthcare"
â”‚       â”œâ”€â”€ ownerId: "user123"
â”‚       â”œâ”€â”€ ownerEmail: "owner@email.com"
â”‚       â”œâ”€â”€ qrCode: "https://nextturn.../join.html?placeId=..."
â”‚       â”œâ”€â”€ avgServiceTime: 5
â”‚       â”œâ”€â”€ enablePriority: true
â”‚       â”œâ”€â”€ enableNotifications: true
â”‚       â”œâ”€â”€ active: true
â”‚       â”œâ”€â”€ totalServed: 42
â”‚       â””â”€â”€ createdAt: 1704451200000
â”‚
â”œâ”€â”€ queues/
â”‚   â””â”€â”€ {placeId}/
â”‚       â””â”€â”€ {queueId}/
â”‚           â”œâ”€â”€ name: "John Doe"
â”‚           â”œâ”€â”€ email: "john@email.com"
â”‚           â”œâ”€â”€ phone: "+1234567890"
â”‚           â”œâ”€â”€ priorityType: "elderly"
â”‚           â”œâ”€â”€ age: 65
â”‚           â”œâ”€â”€ position: 3
â”‚           â”œâ”€â”€ status: "waiting" | "called" | "completed"
â”‚           â”œâ”€â”€ token: "T-ABC123"
â”‚           â”œâ”€â”€ estimatedTime: 15
â”‚           â”œâ”€â”€ notificationSent: false
â”‚           â”œâ”€â”€ placeId: "..."
â”‚           â”œâ”€â”€ placeName: "Hospital XYZ"
â”‚           â”œâ”€â”€ createdAt: 1704451200000
â”‚           â”œâ”€â”€ calledAt: null
â”‚           â””â”€â”€ completedAt: null
â”‚
â”œâ”€â”€ users/
â”‚   â””â”€â”€ {uid}/
â”‚       â”œâ”€â”€ email: "owner@email.com"
â”‚       â”œâ”€â”€ role: "admin"
â”‚       â””â”€â”€ places/
â”‚           â””â”€â”€ {placeId}/
â”‚               â”œâ”€â”€ name: "Hospital XYZ"
â”‚               â”œâ”€â”€ role: "owner"
â”‚               â””â”€â”€ addedAt: 1704451200000
â”‚
â””â”€â”€ analytics/
    â””â”€â”€ {placeId}/
        â”œâ”€â”€ totalServed: 42
        â”œâ”€â”€ avgWaitTime: 12
        â””â”€â”€ peakHours: {
            "09": 15,
            "10": 22,
            "14": 18
        }
```

---

## ğŸ¨ Email Template Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     GRADIENT HEADER (Purple)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚     WHITE CONTENT CARD      â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚  ğŸŸï¸ Title (Blue)            â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚  Hello [Name],              â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚  Message text...            â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  INFO BOX (Grey)    â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Token: T-ABC123    â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Position: #3       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Wait: 15 min       â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚  Additional info...         â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚  Footer: Next Turn          â”‚   â”‚
â”‚  â”‚  Smart Queue Management     â”‚   â”‚
â”‚  â”‚  [Visit Dashboard]          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Security Layer

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         USER REQUEST                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      VERCEL EDGE NETWORK              â”‚
â”‚  â€¢ DDoS Protection                    â”‚
â”‚  â€¢ Rate Limiting                      â”‚
â”‚  â€¢ SSL/TLS Encryption                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     SERVERLESS FUNCTIONS              â”‚
â”‚  â€¢ Input Validation                   â”‚
â”‚  â€¢ CORS Headers                       â”‚
â”‚  â€¢ Error Handling                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
       â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Firebase   â”‚  â”‚    Gmail     â”‚
â”‚  â€¢ Auth     â”‚  â”‚  â€¢ TLS       â”‚
â”‚  â€¢ Rules    â”‚  â”‚  â€¢ OAuth2    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Performance Optimization

```
Request Flow:

Cold Start (First Request):
User Request â†’ Vercel â†’ Initialize â†’ Process â†’ Response
              200ms     1000ms      300ms     â‰ˆ1500ms

Warm Start (Subsequent):
User Request â†’ Vercel â†’ Process â†’ Response
              50ms      200ms     â‰ˆ250ms

Static Files:
User Request â†’ Vercel CDN â†’ Cached Response
              10ms         â‰ˆ10ms

Database Read:
API â†’ Firebase â†’ Data â†’ API
      100ms             â‰ˆ100ms

Email Send:
API â†’ Gmail SMTP â†’ Delivery
      2000ms           â‰ˆ2000ms

AI Calculation:
API â†’ Gemini â†’ Result â†’ Fallback (if fails)
      1000ms           or 50ms
```

---

## ğŸ”„ Deployment Pipeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Local Code   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ git push / vercel deploy
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vercel Build      â”‚
â”‚  â€¢ Install deps    â”‚
â”‚  â€¢ Check syntax    â”‚
â”‚  â€¢ Bundle code     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Build Success
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Deploy Functions  â”‚
â”‚  â€¢ API endpoints   â”‚
â”‚  â€¢ Env variables   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Deploy Static     â”‚
â”‚  â€¢ HTML/CSS/JS     â”‚
â”‚  â€¢ Images          â”‚
â”‚  â€¢ CDN cache       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   LIVE ON VERCEL   â”‚
â”‚  nextturn-three    â”‚
â”‚   .vercel.app      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Visual Guide Complete! ğŸ“Š**

This document shows the complete architecture of your Next Turn platform.
